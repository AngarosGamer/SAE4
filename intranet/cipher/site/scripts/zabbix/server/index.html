
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://192.168.0.3/scripts/zabbix/server/">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.5">
    
    
      
        <title>Mise en place de Zabbix - Cipher - Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7a7fce14.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="light-green" data-md-color-accent="green">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mise-en-place-de-zabbix" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../../.." title="Cipher - Documentation" class="md-header__button md-logo" aria-label="Cipher - Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cipher - Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mise en place de Zabbix
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/AngarosGamer/SAE4" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Onglets" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Accueil
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../commencer/" class="md-tabs__link">
      Commencer
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../" class="md-tabs__link">
      Scripts
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../troubleshooting/" class="md-tabs__link">
      Troubleshoot
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Cipher - Documentation" class="md-nav__button md-logo" aria-label="Cipher - Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Cipher - Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/AngarosGamer/SAE4" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Accueil
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../commencer/" class="md-nav__link">
        Commencer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Scripts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../troubleshooting/" class="md-nav__link">
        Troubleshoot
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequis" class="md-nav__link">
    Prérequis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#telechargement" class="md-nav__link">
    Téléchargement
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilisation" class="md-nav__link">
    Utilisation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-de-zabbix" class="md-nav__link">
    Configuration de Zabbix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-des-machines-a-superviser" class="md-nav__link">
    Configuration des machines à superviser
  </a>
  
    <nav class="md-nav" aria-label="Configuration des machines à superviser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decouverte-des-machines" class="md-nav__link">
    Découverte des machines
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actions-de-decouverte" class="md-nav__link">
    Actions de découverte
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifications" class="md-nav__link">
    Vérifications
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="mise-en-place-de-zabbix">Mise en place de Zabbix</h1>
<p>Zabbix est un outil de supervision d'infrastructure, qui permet de surveiller l'état de l'infrastructure, et d'être alerté en cas de problème.
Le script de mise en place de Zabbix permet de mettre en place un serveur Zabbix, qui sera utilisé pour surveiller l'infrastructure, il est semi-automatique, et nécessite une intervention manuelle pour la configuration de certains paramètres.</p>
<p>De plus, la fin de l'installation se fait sur l'interface web de Zabbix, de manière manuelle.</p>
<h2 id="prerequis">Prérequis</h2>
<ul>
<li>Un espace de stockage d'environ 5Go</li>
<li>Un accès <code>root</code> à la machine virtuelle</li>
<li>Une connexion internet active est nécessaire pour lancer ce script.</li>
</ul>
<h2 id="telechargement">Téléchargement</h2>
<p>Le script de mise en place de Zabbix est disponible ici : <a href="https://raw.githubusercontent.com/AngarosGamer/SAE4/main/zabix/zabbix_install_.sh">Installation Zabbix</a></p>
<h2 id="utilisation">Utilisation</h2>
<p>Pour installer le serveur zabbix, il suffit de lancer le script <code>zabbix_install.sh</code> téléchargé au-dessus en tant que <code>root</code> :</p>
<pre><code class="language-bash">root@machine:~# ./zabbix_install.sh
</code></pre>
<p>Afin de faire tourner ce script, il sera possiblement nécessaire de lui donner les droits d'exécution :</p>
<pre><code class="language-bash">root@machine:~# chmod +x zabbix_install.sh
</code></pre>
<h2 id="configuration">Configuration</h2>
<p>Le script va commencer par installer tous les paquets nécessaires à l'installation de Zabbix, puis va configurer la base de données MySQL, et enfin va configurer Zabbix.</p>
<p>Pendant l'utilisation du script, on vous demandera de rentrer des informations, il s'agit du :</p>
<ul>
<li>Mot de passe de la base de données</li>
<li>Paramètres de la base de données</li>
</ul>
<p>Cette opération est à faire manuellement, même si les paramètres par défaut sont proposés et généralement acceptés.</p>
<p>Suite à cela le script se mettre en pause et demandera de compléter les conditions d'installation. Il faudra donc :</p>
<ul>
<li>Effectuer cette commande</li>
</ul>
<pre><code class="language-bash">root@machine:~# mysql -uroot
</code></pre>
<p>Puis exectuer la commande suivante pour créer la base de données :</p>
<pre><code class="language-bash">MariaDB [(none)]&gt; create database zabbix character set utf8mb4 collate utf8mb4_bin;
</code></pre>
<p>Puis exectuer la commande suivante pour créer l'utilisateur et donner les permissions :</p>
<pre><code class="language-bash">MariaDB [(none)]&gt; grant all privileges on zabbix.* to zabbix@localhost identified by &lt;mot de passe&gt;;
</code></pre>
<p>Une fois ces deux opérations terminées, poursuivre dans l'installation du script.</p>
<p>Attention, certaines étapes de l'installation sont longues.</p>
<p>Lorsque le script se termine, il demandera de se connecter à l'interface web de Zabbix, pour cela il faudra se rendre sur l'adresse <code>http://&lt;adresse IP de la machine&gt;/zabbix</code> et se connecter avec les identifiants par défaut :</p>
<ul>
<li>Identifiant : <code>Admin</code></li>
<li>Mot de passe : <code>zabbix</code></li>
</ul>
<h2 id="configuration-de-zabbix">Configuration de Zabbix</h2>
<p>Une fois connecté à l'interface web de Zabbix, il faudra configurer le serveur Zabbix, pour cela il faudra utiliser principalement les paramètres par défaut proposés par l'interface web.</p>
<p>Il faudra cependant entrer le mot de passe de la base de données, et le nom de la base de données, qui sont les mêmes que ceux rentrés lors de l'installation.</p>
<h2 id="configuration-des-machines-a-superviser">Configuration des machines à superviser</h2>
<p>Pour utiliser Zabbix, il faut pouvoir détecter les machines à superviser. Zabbix le permet de manière automatique, mais il doit être configuré pour cela.</p>
<h3 id="decouverte-des-machines">Découverte des machines</h3>
<p>Pour que Zabbix puisse détecter les machines à superviser, il faut créer une (ou plusieurs) règles de découverte.</p>
<p>Pour cela, il faut se rendre dans la section <code>Collecte de données</code> de l'interface web de Zabbix, puis dans la sous-section <code>Découverte</code>.</p>
<p>Ici, cliquez sur le bouton <code>Créer une découverte</code> et entrez les informations suivantes :</p>
<ul>
<li>Nom : <code>&lt;un nom approprié à la règle voulue, ex: dmz-discovery&gt;</code></li>
<li>Proxy : <code>Aucun (sauf si vous utilisez un proxy)</code></li>
<li>Plage d'adresses IP : <code>&lt;Une plage d'IP, ex: 192.168.0.0/24&gt;</code></li>
<li>Intervalle d'actualisation : <code>1h</code></li>
<li>Vérifications :</li>
<li><code>Ping ICMP</code></li>
</ul>
<p>Pour le reste, la configuration par défaut est suffisante.</p>
<p>Cliquez sur ajouter, et la règle de découverte est créée.</p>
<h3 id="actions-de-decouverte">Actions de découverte</h3>
<p>Une fois la règle de découverte créée, il faut créer une action de découverte, qui permettra de créer les hôtes dans Zabbix et éventuellement d'effectuer les actions voulues.</p>
<p>Pour cela, il faut se rendre dans la section <code>Alertes</code> de l'interface web de Zabbix, puis dans la sous-section <code>Actions</code>, et enfin sur <code>Actions de découverte</code>.</p>
<p>Ici, cliquez sur le bouton <code>Créer une action</code> et entrez les informations suivantes :</p>
<ul>
<li>Nom : <code>&lt;un nom approprié à l'action voulue, ex: dmz-action&gt;</code></li>
<li>Conditions :</li>
<li>Type : <code>Test de découverte</code></li>
<li>Opérateur : <code>égal</code></li>
<li>Test de découverte : <code>&lt;règle créée précédemment&gt;</code></li>
<li>Opérations :</li>
<li>Opération : <code>Ajouter hôte</code></li>
<li>Opération : <code>Ajouter au groupe d'hôtes</code><ul>
<li>Groupe d'hôtes : <code>&lt;Linux Servers&gt;</code></li>
</ul>
</li>
</ul>
<p>Ajoutez cette action, et c'est terminé!</p>
<h3 id="verifications">Vérifications</h3>
<p>Vous pouvez éventuellement relancer le service Zabbix sur le serveur pour prendre en compte les changements:</p>
<pre><code class="language-bash">root@machine:~# systemctl restart zabbix-server
</code></pre>
<p>Au bout d'un certain temps (ce n'est pas instantané), vous pouvez également vérifier que les hôtes sont bien détectés dans l'interface web de Zabbix, dans la section <code>Hôtes</code> de l'interface web de Zabbix.</p>



  



                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Retour en haut de la page
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.407015b8.min.js"></script>
      
    
  </body>
</html>